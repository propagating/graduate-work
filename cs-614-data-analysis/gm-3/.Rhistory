knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(DAAG)
install.packages("DAAG")
install.packages("lmerTest")
install.packages("lme4")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(DAAG)
library(lmerTest)
library(lme4)
data = read.csv("politeness_data.csv")
data$attitude = as.factor(data$attitude)
data$gender = as.factor(data$gender)
data$scenario = as.factor(data$scenario)
randomIntercept = lmer(frequency ~ (1|subject) + gender + attitude)
randomIntercept = lmer(frequency ~ (1|subject) + gender + attitude, data = data)
summary(randomIntercept)
dTest = read.csv("politeness_data.csv")
randomIntercept = lmer(frequency ~ (1|subject) + gender + attitude, data = dTest)
summary(randomIntercept)
randomIntercept = lmer(frequency ~ (1|subject) + gender + attitude, data = data)
summary(randomIntercept)
randomSlope =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data)
summary(randomSlope)
lmer(frequency ~ (attitude|subject) + gender + attitude, data = dtest)
lmer(frequency ~ (attitude|subject) + gender + attitude, data = dTest)
summary(lmer(frequency ~ (attitude|subject) + gender + attitude, data = dTest))
multipleRandom = lmer(frequence~(1|subject) + gender + attitude + (1|scenario), data = data)
multipleRandom = lmer(frequency ~ (1|subject) + gender + attitude + (1|scenario), data = data)
summary(multipleRandom)
randomIntercept = lmer(frequency ~ (1|subject) + gender + attitude, data = data)
summary(randomIntercept)
randomSlope =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data)
summary(randomSlope)
multipleRandom = lmer(frequency ~ (1|subject) + gender + attitude + (1|scenario), data = data)
summary(multipleRandom)
summary(randomIntercept)
summary(randomSlope)
randomSlope
randomInterceptVariance = 603.9 + 850.9
summary(randomIntercept)
randomInterceptVariance = 603.9 + 850.9
summary(randomIntercept)
randomInterceptVariance = 603.9 + 850.9
subjectVariance = 603.9/randomInterceptVariance
residualVariance = 850.9/randomInerceptVariance
summary(randomIntercept)
randomInterceptVariance = 603.9 + 850.9
subjectVariance = 603.9/randomInterceptVariance
residualVariance = 850.9/randomInterceptVariance
subjectVariance
randomInterceptF = lmer(frequency ~ (1|subject) + gender + attitude, data = data, REML = FALSE)
summary(randomInterceptF)
ranef(randomInterceptEffects)$subject
randomInterceptEffects = ranef(randomIntercept)$subject
plot(density(randomInterceptEffects))
plot(unlist(density(randomInterceptEffects)))
randomInterceptEffects = ranef(randomIntercept)$subject
plot((density(unlist(randomInterceptEffects)))
summary(randomIntercept)
randomInterceptVariance = 603.9 + 850.9
subjectVariance = 603.9/randomInterceptVariance
residualVariance = 850.9/randomInterceptVariance
subjectVariance
randomInterceptF = lmer(frequency ~ (1|subject) + gender + attitude, data = data, REML = FALSE)
randomInterceptEffects = ranef(randomIntercept)$subject
plot((density(unlist(randomInterceptEffects)))
plot(density(unlist(randomInterceptEffects)))
plot.kde(unlist(randomInterceptEffects))
plot(density(unlist(randomInterceptEffects)))
icc(randomIntercept)1
icc(randomIntercept)
library(irr)
install.packages("irr")
icc(randomIntercept)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(DAAG)
library(lmerTest)
library(lme4)
library(irr)
summary(randomIntercept)
randomInterceptVariance = 603.9 + 850.9
subjectVariance = 603.9/randomInterceptVariance
residualVariance = 850.9/randomInterceptVariance
icc(randomIntercept)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(DAAG)
library(lmerTest)
library(lme4)
summary(randomIntercept)
randomInterceptVariance = 603.9 + 850.9
subjectVariance = 603.9/randomInterceptVariance
residualVariance = 850.9/randomInterceptVariance
subjectVariance
randomInterceptF = lmer(frequency ~ (1|subject) + gender + attitude, data = data, REML = FALSE)
randomInterceptEffects = ranef(randomIntercept)$subject
plot(density(unlist(randomInterceptEffects)))
summary(randomSlope)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)$attitude
plot(kde2d(unlist(randomSlopeSubjectEffect), unlistrandomSlopeAttitudetEffect()))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(DAAG)
library(lmerTest)
library(lme4)
library(MASS)
summary(randomSlope)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)$attitude
plot(kde2d(unlist(randomSlopeSubjectEffect), unlistrandomSlopeAttitudetEffect()))
plot(kde2d(unlist(randomSlopeSubjectEffect), unlist(randomSlopeAttitudetEffect)))
summary(randomSlope)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)$attitude
plot(kde2d(unlist(randomSlopeSubjectEffect), unlist(randomSlopeAttitudetEffect)))
summary(randomSlope)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)$attitude
plot(kde2d(unlist(randomSlopeSubjectEffect), unlist(randomSlopeAttitudetEffect)))
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlopeF)$subject
randomSlopeAttitudetEffect = ranef(randomSlopeF)$attitude
plot(kde2d(unlist(randomSlopeSubjectEffect), unlist(randomSlopeAttitudetEffect)))
randomSlopeAttitudetEffect = ranef(randomSlopeF)
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlopeF)$subject
randomSlopeAttitudetEffect = ranef(randomSlopeF)$attitudepol
plot(kde2d(unlist(randomSlopeSubjectEffect), unlist(randomSlopeAttitudetEffect)))
randomSlopeAttitudetEffect = ranef(randomSlope)
View(randomSlope)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(DAAG)
library(lmerTest)
library(lme4)
library(MASS)
dTest = read.csv("politeness_data.csv")
data = read.csv("politeness_data.csv")
data$gender = as.factor(data$gender)
data$scenario = as.factor(data$scenario)
randomIntercept = lmer(frequency ~ (1|subject) + gender + attitude, data = data)
randomSlope =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data)
multipleRandom = lmer(frequency ~ (1|subject) + gender + attitude + (1|scenario), data = data)
summary(randomIntercept)
randomInterceptVariance = 603.9 + 850.9
subjectVariance = 603.9/randomInterceptVariance
residualVariance = 850.9/randomInterceptVariance
subjectVariance
randomInterceptF = lmer(frequency ~ (1|subject) + gender + attitude, data = data, REML = FALSE)
randomInterceptEffects = ranef(randomIntercept)$subject
plot(density(unlist(randomInterceptEffects)))
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)
plot(kde2d(unlist(randomSlopeSubjectEffect), unlist(randomSlopeAttitudetEffect)))
summary(multipleRandom)
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)$attitude
plot(kde2d(unlist(randomSlopeSubjectEffect), unlist(randomSlopeAttitudetEffect)))
summary(multipleRandom)
multipleRandomVariance = 219.5 + 615.6 + 645.9
multipleScenarioVariance =219.5/multipleRandomVariance
multipleSubjectVariance = 615.6/multipleRandomVariance
multipleScenarioVariance
multipleSubjectVariance
multipleRandomF = lmer(frequency ~ (1|subject) + gender + attitude + (1|scenario), data = data, REML = FALSE)
multipleRandomInterceptEffect = ranef(multipleRandom)$subject
plot(density(unlist(multipleRandomInterceptEffect)))
AIC(randomInterceptF, randomSlopeF, multipleRandomF)
ANOVA(randomInterceptF, randomSlopeF, multipleRandomF)
aov(randomInterceptF, randomSlopeF)
anova(fit.randomInterceptF, fit.randomSlopeF)
anova(randomInterceptF, randomSlopeF)
anova(randomSlopeF, multipleRandomF)
anova(randomInterceptF, multipleRandomF)
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)$attitude
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)$attitude
View(randomSlope)
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = unlist(ranef(randomSlope)$subject)
randomSlopeAttitudetEffect = unlist(ranef(randomSlope)$attitude)
plot(kde2d(randomSlopeSubjectEffect, randomSlopeAttitudetEffect))
ranef(randomSlope)
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = unlist(ranef(randomSlope)$subject)
randomSlopeAttitudetEffect = unlist(ranef(randomSlope)$attitudepol)
ranef(randomSlope)
plot(kde2d(randomSlopeSubjectEffect, randomSlopeAttitudetEffect))
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = unlist(ranef(randomSlope)$subject)
randomSlopeAttitudetEffect = unlist(ranef(randomSlope)$subject.attitudepol)
ranef(randomSlope)
plot(kde2d(randomSlopeSubjectEffect, randomSlopeAttitudetEffect))
ranef(randomIntercept)
ranef(multipleRandom)
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)$attitude
ranef(randomSlope)
plot(kde2d(randomSlopeSubjectEffect, randomSlopeAttitudetEffect))
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)$attitude
ranef(randomSlope)
plot(kde2d(randomSlopeSubjectEffect, randomSlopeAttitudetEffect))
ranef(randomSlope)
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)$attitudepol
ranef(randomSlope)
plot(kde2d(randomSlopeSubjectEffect, randomSlopeAttitudetEffect))
summary(randomSlope)
randomSlope =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
slopeEffects = ranef(randomSlope)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeAttitudetEffect = ranef(randomSlope)$attitudepol
plot(kde2d(randomSlopeSubjectEffect, randomSlopeAttitudetEffect))
View(slopeEffects)
slopeEffects = unlist(ranef(randomSlope))
slopeEffects$subject
slopeEffects
randomSlopeSubjectEffect[0]
randomSlopeSubjectEffect[,1]
randomSlopeSubjectEffect[,2]
plot(kde2d(randomSlopeSubjectEffect[,1], randomSlopeSubjectEffect[,2]))
contour(density(unlist(multipleRandomInterceptEffect)))
contour(kde2d(randomSlopeSubjectEffect[,1], randomSlopeSubjectEffect[,2]))
summary(multipleRandom)
multipleRandomVariance = 219.5 + 615.6 + 645.9
multipleScenarioVariance =219.5/multipleRandomVariance
multipleSubjectVariance = 615.6/multipleRandomVariance
multipleScenarioVariance
multipleSubjectVariance
multipleRandomF = lmer(frequency ~ (1|subject) + gender + attitude + (1|scenario), data = data, REML = FALSE)
multipleRandomInterceptEffect = ranef(multipleRandom)$subject
ranef(multipleRandom)
plot(density(unlist(multipleRandomInterceptEffect)))
summary(randomSlope)
randomSlope =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
slopeEffects = unlist(ranef(randomSlope))
randomSlopeSubjectEffect = ranef(randomSlope)$subject
randomSlopeSubjectEffect[,1]
randomSlopeSubjectEffect[,2]
randomSlopeAttitudetEffect = ranef(randomSlope)$attitude
contour(kde2d(randomSlopeSubjectEffect[,1], randomSlopeSubjectEffect[,2]))
summary(multipleRandom)
multipleRandomVariance = 219.5 + 615.6 + 645.9
multipleScenarioVariance =219.5/multipleRandomVariance
multipleSubjectVariance = 615.6/multipleRandomVariance
multipleScenarioVariance
multipleSubjectVariance
multipleRandomF = lmer(frequency ~ (1|subject) + gender + attitude + (1|scenario), data = data, REML = FALSE)
multipleRandomInterceptEffect = ranef(multipleRandom)$subject
ranef(multipleRandom)
plot(density(unlist(multipleRandomInterceptEffect)))
summary(multipleRandom)
multipleRandomVariance = 219.5 + 615.6 + 645.9
multipleScenarioVariance =219.5/multipleRandomVariance
multipleSubjectVariance = 615.6/multipleRandomVariance
multipleScenarioVariance
multipleSubjectVariance
multipleRandomF = lmer(frequency ~ (1|subject) + gender + attitude + (1|scenario), data = data, REML = FALSE)
multipleRandomInterceptEffect = ranef(multipleRandom)$subject
multipleRandomInterceptEffectScenario = ranef(multipleRandom)$scenario
ranef(multipleRandom)
plot(density(unlist(multipleRandomInterceptEffect)))
plot(density(unlist(multipleRandomInterceptEffectScenario)))
VarCorr(randomSlope)
rand(randomSlope)
varianceCorrelation = VarCorr(randomSlope) %>% as_data_frame()
varianceCorrelation = VarCorr(randomSlope) %>% as_data_frame() %>% mutate(icc=vcov/sum(vcov))%>%selec(grp,icc)
varianceCorrelation = VarCorr(randomSlope) %>% as_data_frame() %>% mutate(icc=vcov/sum(vcov))%>%select(grp,icc)
varianceCorrelation = VarCorr(randomSlope) %>% as_data_frame() %>% mutate(icc=vcov/sum(vcov))
varianceCorrelation = VarCorr(randomSlope) %>% as_data_frame() %>% mutate(icc=vcov/sum(vcov)) %>% select(grp,icc)
varianceCorrelation$grp
varianceCorrelation$icc
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
contour(kde2d(randomSlopeSubjectEffect[,1], randomSlopeSubjectEffect[,2]))
varianceCorrelation = VarCorr(randomSlope)
%>% as_data_frame()
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
contour(kde2d(randomSlopeSubjectEffect[,1], randomSlopeSubjectEffect[,2]))
varianceCorrelation = VarCorr(randomSlope) %>% as_data_frame() %>% mutate(icc=vcov/sum(vcov))
VPC = data.frame(varianceCorrelation$grp, varianceCorrelation$icc)
VPC
summary(randomSlope)
randomSlopeF =  lmer(frequency ~ (attitude|subject) + gender + attitude, data = data, REML=FALSE)
randomSlopeSubjectEffect = ranef(randomSlope)$subject
contour(kde2d(randomSlopeSubjectEffect[,1], randomSlopeSubjectEffect[,2]))
varianceCorrelation = VarCorr(randomSlope) %>% as_data_frame() %>% mutate(icc=vcov/sum(vcov))
VPC = data.frame(varianceCorrelation$grp, varianceCorrelation$icc)
VPC
read.table("FITglm2.text")
read.data("FITglm2.text")
read.file("FITglm2.text")
read.file("FITglm2.txt")
read.table("FITglm2.txt")
read.table("FITglm2.txt", header=TRUE, sep = " ")
read.table("FITglm2.txt", header=TRUE)
read.table("FITglm2.txt", header=TRUE, fill=TRUE)
