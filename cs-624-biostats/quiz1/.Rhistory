library(tidyverse)
install.packages(tidyverse)
install.packages("tidyverse")
library(tidyverse)
mpgData = mpg
library(ggplot2)
mpgData = mpg
summary(mpgData)
head(mpgData)
mpgData$manufacturer = as.factor(mpgData$manufacturer)
mpgData$model = as.factor(mpgData$model)
mpgData$cyl = as.factor(mpgData$cyl)
mpgData$drv = as.factor(mpgData$drv)
mpgData$fl = as.factor(mpgData$fl)
mpgData$class = as.factor(mpgData$class)
mpgData$trans = as.factor(mpgData$trans)
summary(mpgData)
mpgData$avgMpg = (mpgData$cty + mpgData$hwy) / 2
dim(mpgData)
names(mpgData)
summary(mpgData)
hist(mpgData$manufacturer)
hist(mpgData$model)
hist(mpgData$displ)
library(tidyr)
ggplot(gather(mpgData), aes(value)) + geom_histogram() + facet_wrap(~key)
ggplot(gather(mpgData), aes(value)) + geom_histogram(bins = 10) + facet_wrap(~key)
hist(mpgData$displ)
hist(mpgData$year)
?hist()
hist(mpgData$year, breaks=9)
boxplot(mpgData$year)
boxplot(mpgData$cyl)
boxplot(mpgData$cty)
boxplot(mpgData$hwy)
boxplot(mpgData$avgMpg)
boxplot(mpgData$displ)
hist(mpgData$displ)
hist(mpgData$year)
hist(mpgData$cty)
hist(mpgData$hwy)
hist(mpgData$avgMpg)
library(MASS)
#Categorical Variables
hist(mpg$manufacturer)
#Categorical Variables
boxplot(mpg$manufacturer)
?stepAIC()
stepAIC(mpgData$avgMpg, mpgData, direction="both")
stepAIC(mpgData, direction="both")
lMod = lm(avgMPG ~ ., data = mpgData)
lMod = lm(avgMpg ~ ., data = mpgData)
stepAIC(lMod, direction="both")
?stepAIC()
lMod = lm(avgMpg ~ ., data = mpgData)
stepMod = stepAIC(lMod, direction="both")
summary(stepMod)
mpgData = subset(mphData, select = -c("cty", "hwy"))
mpgData = subset(mpgData, select = -c("cty", "hwy"))
mpgData = mpgData[, names(mpgData) %in% c("cty", "hwy")]
library(ggplot2)
library(tidyr)
library(MASS)
mpgData = mpg
#Question 1a
summary(mpgData)
head(mpgData)
mpgData$manufacturer = as.factor(mpgData$manufacturer)
mpgData$model = as.factor(mpgData$model)
mpgData$cyl = as.factor(mpgData$cyl)
mpgData$drv = as.factor(mpgData$drv)
mpgData$fl = as.factor(mpgData$fl)
mpgData$class = as.factor(mpgData$class)
mpgData$trans = as.factor(mpgData$trans)
mpgData$avgMpg = (mpgData$cty + mpgData$hwy) / 2
mpgData = mpgData[, !names(mpgData) %in% c("cty", "hwy")]
dim(mpgData)
# Variable Names
names(mpgData)
# Summary Stats
summary(mpgData)
# Plots cannot plot categorical variables, additionaly, cannot use default cols from mpg data as they are of type chr, not numericand cannot be graphed.
hist(mpgData$displ)
hist(mpgData$year)
hist(mpgData$avgMpg)
boxplot(mpgData$displ)
boxplot(mpgData$year)
boxplot(mpgData$avgMpg)
lMod = lm(avgMpg ~ ., data = mpgData)
stepMod = stepAIC(lMod, direction="both")
summary(stepMod)
bestMainEffects = lm(formula = avgMpg ~ model + displ + year + cyl + fl, data = mpgData)
plot(bestMainEffects)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyr)
library(MASS)
mpgData = mpg
summary(mpgData)
head(mpgData)
mpgData$manufacturer = as.factor(mpgData$manufacturer)
mpgData$model = as.factor(mpgData$model)
mpgData$cyl = as.factor(mpgData$cyl)
mpgData$drv = as.factor(mpgData$drv)
mpgData$fl = as.factor(mpgData$fl)
mpgData$class = as.factor(mpgData$class)
mpgData$trans = as.factor(mpgData$trans)
mpgData$avgMpg = (mpgData$cty + mpgData$hwy) / 2
mpgData = mpgData[, !names(mpgData) %in% c("cty", "hwy")]
names(mpgData)
dim(mpgData)
summary(mpgData)
lMod = lm(avgMpg ~ ., data = mpgData)
stepMod = stepAIC(lMod, direction="both")
summary(stepMod)
bestMainEffects = lm(formula = avgMpg ~ model + displ + year + cyl + fl, data = mpgData)
plot(bestMainEffects)
lMod = lm(avgMpg ~ .^2, data = mpgData)
stepMod = stepAIC(lMod, direction="both")
library(ggplot2)
library(tidyr)
library(MASS)
mpgData = mpg
summary(mpgData)
head(mpgData)
mpgData$manufacturer = as.factor(mpgData$manufacturer)
mpgData$model = as.factor(mpgData$model)
mpgData$cyl = as.factor(mpgData$cyl)
mpgData$drv = as.factor(mpgData$drv)
mpgData$fl = as.factor(mpgData$fl)
mpgData$class = as.factor(mpgData$class)
mpgData$trans = as.factor(mpgData$trans)
mpgData$avgMpg = (mpgData$cty + mpgData$hwy) / 2
mpgData = mpgData[, !names(mpgData) %in% c("cty", "hwy")]
names(mpgData)
dim(mpgData)
summary(mpgData)
lMod = lm(avgMpg ~ ., data = mpgData)
stepMod = stepAIC(lMod, direction="both", k=2)
summary(stepMod)
lMod = lm(avgMpg ~ .^2, data = mpgData)
stepMod = stepAIC(lMod, direction="both")
lModInteractions = lm(formula = avgMpg ~ model + displ + year + cyl + fl, data = mpgData) ^2
stepModInteractions = stepAIC(lModInteractions, direction="both")
summary(stepModInteractions)
lModInteractions = lm(formula = avgMpg ~ model + displ + year + cyl + fl, data = mpgData) ^2
bestMainDf = data.frame(mpgData$avgMpg, mpgData$model, bestMainDf$displ, mpgData$year,mpgData$cyl, mpgData$fl)
bestMainDf = data.frame(mpgData$avgMpg, mpgData$model, mpgData$displ, mpgData$year,mpgData$cyl, mpgData$fl)
lModInteractions = lm(formula = avgMpg ~ .^2, data = bestMainDf)
lModInteractions = lm(formula = mpgData.avgMpg ~ .^2, data = bestMainDf)
stepModInteractions = stepAIC(lModInteractions, direction="both")
bestMainInteractionsEffects = lm(formula = mpgData.avgMpg ~ mpgData.model + mpgData.displ + mpgData.year +
mpgData.cyl + mpgData.fl + mpgData.model:mpgData.displ +
mpgData.model:mpgData.year + mpgData.displ:mpgData.year +
mpgData.displ:mpgData.fl + mpgData.year:mpgData.cyl, data = bestMainDf)
plot(bestMainInteractionsEffects)
bestMainEffects = lm(formula = avgMpg ~ model + displ + year + cyl + fl, data = mpgData)
plot(bestMainEffects)
summary(bestMainEffects)
summary(bestMainInteractionsEffects)
