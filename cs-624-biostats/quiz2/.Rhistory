library(tidyverse)
library(foreign)
library(faraway)
install.packages("faraawy")
?wcgs
??wcgs
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(foreign)
d <- read.dta('wcgs.dta')
View(d)
```{r pre-processing}
summary(d)
d$arcus = as.factor(d$arcus)
d$typchd69 = as.factor(d$typchd69)
summary(d$age)
dTrim = d[, -c(10,11,12)]
summary(dTrim)
dTrim = d[, -c(10,11,12,15,17,20)]
summary(dTrim)
dTrim = d[, -c(10,11,12,15,17,18,20)]
summary(dTrim)
dTrim = d[, -c(1,5,10,11,12,15,17,18,20)]
summary(dTrim)
dTrim = d[, -c(1,5,8,10,11,12,15,17,18,20)]
dTrim = d[, -c(1,5,8,10,11,12,15,16,17,18,19,20)]
summary(dTrim)
dTrim = d[, -c(5,8,10,11,12,15,16,17,18,19,20,22)]
summary(dTrim)
dTrim = d[, -c(5,8,10,11,12,15,16,17,18,19,21,22)]
summary(dTrim)
dTrim = d[, -c(8,10,11,12,15,16,17,18,19,21,22)]
summary(dTrim)
logit <- glm(chd69 ~., data = dtrim, family = "binomial")
logit <- glm(chd69 ~., data = dTrim, family = "binomial")
summary(logit)
library(MASS)
stepAIC(logit)
step<- stepAIC(logit)
step
step$model
bestModel = glm(step)
bestModel = glm(step$model)
bestModel = glm(step$formula)
bestModel = glm(step$formula, data = step$model)
bestModel = glm(step$formula, data = dTrim)
step$formula
bestModel = glm(paste0(step$formula), data = dTrim)
bestModel = glm(chd69 ~ age + arcus + behpat + bmi + chol + height + ncigs +
sbp, data = dTrim)
bestModel = glm(chd69 ~ age + arcus + behpat + bmi + chol + height + ncigs + sbp, data = dTrim)
bestModel = glm(step$formula, data = step$model, family="binomial")
summary(bestModel)
exp(bestModel$coefficients)
summary(bestModel)
exp(bestModel$coefficients)
roc(bestModel)
library(pROC)
predictions = predict(bestModel)
rCurve = roc(dTrim$chd69~predictions)
?roc
rCurve = roc(dTrim$chd69~predictions, na.action="na.omit")
rCurve = roc(dTrim$chd69~predictions, na.rm = TRUE)
rCurve = roc(dTrim$chd69~predictions, na.action="na.rm = TRUE")
rCurve = roc(dTrim$chd69~predictions, na.action='na.rm = TRUE')
dTrim = na.omit(dTrim)
rCurve = roc(dTrim$chd69~predictions, na.action='na.rm = TRUE')
rCurve = roc(dTrim$chd69~predictions)
rCurve
plot(rCurve)
rCurve$auc
coords(rCurve, "best", ret ="threshold")
predictions = predict(bestModel)
dTrim = na.omit(dTrim)
rCurve = roc(dTrim$chd69~predictions)
plot(rCurve)
coords(rCurve, "best", ret ="threshold")
rCurve
coords(rCurve, "best", ret ="threshold")
```{r interactionModelBuilding}
logit2 <- glm(chd69 ~.^2, data = dTrim, family = "binomial")
step2<- stepAIC(logit)
logit2 <- glm(chd69 ~^2., data = dTrim, family = "binomial")
logit2 <- glm(chd69 ~^2, data = dTrim, family = "binomial")
logit2 <- glm(chd69 ~.^2, data = dTrim, family = "binomial")
step2<- stepAIC(logit2)
step2 $formula
glm(step$formula, data = step$model, family="binomial")
summary(bestMo
el2)
summary(bestModel2)
```{r setup, include=FALSE}
library(tidyverse)
library(foreign)
library(MASS)
library(pROC)
d <- read.dta('wcgs.dta')
d$arcus = as.factor(d$arcus)
logit <- glm(chd69 ~., data = dTrim, family = "binomial")
step<- stepAIC(logit)
step$formula
bestModel = glm(step$formula, data = step$model, family="binomial")
summary(bestModel)
```{r modelBuilding, echo = FALSE}
logit <- glm(chd69 ~., data = dTrim, family = "binomial")
step<- stepAIC(logit)
step$formula
bestModel = glm(step$formula, data = step$model, family="binomial")
summary(bestModel)
step<- stepAIC(logit, trace = FALSE)
bestModel = glm(step$formula, data = step$model, family="binomial")
summary(bestModel)
exp(bestModel$coefficients)
predictions = predict(bestModel)
dTrim = na.omit(dTrim)
plot(rCurve)
rCurve
coords(rCurve, "best", ret ="threshold")
plot(rCurve)
logit2 <- glm(chd69 ~.^2, data = dTrim, family = "binomial")
step2<- stepAIC(logit2, trace = FALSE)
bestModel2 = glm(step2$formula, data = step2$model, family="binomial")
summary(bestModel2)
predictions2 = predict(bestModel2)
rCurve2 = roc(dTrim$chd69~predictions2)
rCurve2
coords(rCurve2, "best", ret ="threshold")
plot(rCurve2)
logit3 <- glm(step$formula^3, data = dTrim, family = "binomial")
logit3 <- glm(paste0(step$formula, '^3'), data = dTrim, family = "binomial")
logit3 <- glm(chd69~.^3, data = dTrim, family = "binomial")
step3<- stepAIC(logit3, trace = FALSE)
View(logit)
exp(-2.34)
exp(-2.47958)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(foreign)
library(MASS)
library(pROC)
library(AER)
exp(shipModel$coefficients)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(foreign)
library(MASS)
library(pROC)
library(AER)
ships <- read.table("https://data.princeton.edu/wws509/datasets/ships.dat", header=TRUE)
ships$type = as.factor(ships$type)
ships$construction = as.factor(ships$construction)
ships$operation = as.factor(ships$operation)
summary(ships)
shipModel = glm( damage ~ type + construction + operation, offset(log(months)),data=ships, family="poisson")
summary(shipModel)
exp(shipModel$coefficients)
d <- read.dta('wcgs.dta')
summary(d)
d$arcus = as.factor(d$arcus)
dTrim = d[, -c(3,5,10,11,12,15,16,19,21,22)]
summary(dTrim)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(foreign)
library(MASS)
library(pROC)
library(AER)
d <- read.dta('wcgs.dta')
summary(d)
d$arcus = as.factor(d$arcus)
dTrim = d[, -c(3,5,10,11,12,15,16,19,21,22)]
summary(dTrim)
logit <- glm(dibpat ~., data = dTrim, family = "binomial")
step<- stepAIC(logit, trace = FALSE)
```{r datacleanup, echo = TRUE}
d$arcus = as.factor(d$arcus)
dTrim = d[, -c(3,5,10,11,12,15,16,19,21,22)]
dTrim = na.omit(dTrim)
summary(dTrim)
logit <- glm(dibpat ~., data = dTrim, family = "binomial")
step<- stepAIC(logit, trace = FALSE)
bestModel = glm(step$formula, data = step$model, family="binomial")
summary(bestModel)
exp(bestModel$coefficients)
d$typchd69 = as.factor(d$typchd69)
dTrim = d[, -c(3,5,10,11,12,15,16,19,21,22)]
dTrim = na.omit(dTrim)
summary(dTrim)
logit <- glm(dibpat ~., data = dTrim, family = "binomial")
step<- stepAIC(logit, trace = FALSE)
bestModel = glm(step$formula, data = step$model, family="binomial")
summary(bestModel)
exp(bestModel$coefficients)
logit <- glm(dibpat ~., data = dTrim, family = "binomial")
step<- stepAIC(logit, trace = FALSE)
bestModel = glm(step$formula, data = step$model, family="binomial")
summary(bestModel)
exp(bestModel$coefficients)
predictions = predict(bestModel)
rCurve = roc(dTrim$dibpat~predictions)
rCurve
coords(rCurve, "best", ret ="threshold")
plot(rCurve)
exp(0.06)
```{r interactionModelBuilding, echo = FALSE}
logit2 <- glm(dibpat ~.^2, data = dTrim, family = "binomial")
step2<- stepAIC(logit2, trace = FALSE)
bestModel2 = glm(step2$formula, data = step2$model, family="binomial")
summary(bestModel2)
predictions2 = predict(bestModel2)
rCurve2 = roc(dTrim$dibpat~predictions2)
rCurve2
coords(rCurve2, "best", ret ="threshold")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(foreign)
library(MASS)
library(pROC)
library(AER)
exp(shipModel$coefficients)
